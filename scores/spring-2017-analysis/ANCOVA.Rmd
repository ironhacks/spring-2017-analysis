---
title: "R Notebook"
output: html_notebook
---

This is an [R Markdown](http://rmarkdown.rstudio.com) Notebook. When you execute code within the notebook, the results appear beneath the code. 

Try executing this chunk by clicking the *Run* button within the chunk or by placing your cursor inside it and pressing *Cmd+Shift+Enter*. 

```{r}
survey <- read.table("/Users/jialincheoh/Desktop/survey_final_read.csv", header=TRUE, sep = ",", stringsAsFactors=T)
names(survey)[35] <- "aspiration"
survey
```
```{r}
scores
```
```{r}
ancova_improve_vis_15 <- cbind(scores[, c(3, 39)], aspiration = survey$aspiration)
ancova_improve_vis_15
```



```{r}
ancova_improve_ur_15 <- cbind(scores[, c(3, 33)], aspiration = survey$aspiration)
ancova_improve_ur_15
```



```{r}
ancova_improve_novel_15 <- cbind(scores[, c(3, 45)], aspiration = survey$aspiration)
ancova_improve_novel_15
```
```{r}
ancova_improve_vis_45 <- cbind(scores[, c(3, 38)], aspiration = survey$aspiration)
ancova_improve_vis_45
```


```{r}
ancova_improve_novel_45 <- cbind(scores[, c(3, 44)], aspiration = survey$aspiration)
ancova_improve_novel_45
```



```{r}
ancova_df <- cbind(scores[, c(3, 52)], aspiration = survey$aspiration)
ancova_df
```

> ANOVA is a parametric test based on the assumption that the data follows normal. hence it is necessary to test the normality.

> If the assumption of normality is violated, or outliers are present, then the one-way ANOVA may not be the most powerful test available, and this could mean the difference between detecting a true difference among the population means or not.



```{r}
shapiro.test(ancova_improve_novel_45$improve.novel.45)
```


> A collection of data samples are independent if they come from unrelated populations and the samples do not affect each other. Using the Kruskal-Wallis Test, we can decide whether the population distributions are identical without assuming them to follow the normal distribution.

```{r}
kruskal.test(improve.novel.45 ~ Group, data = ancova_improve_novel_45) 
```
```{r}
kruskal.test(improve.novel.15 ~ Group, data = ancova_improve_novel_15) 
```
```{r}
kruskal.test(improve.tech.15 ~ Group, data = ancova_df) 
```
```{r}
kruskal.test(improve.vis.45 ~ Group, data = ancova_improve_vis_45) 
```
```{r}
kruskal.test(improve.vis.15 ~ Group, data = ancova_improve_vis_15) 
```


```{r}
kruskal.test(improve.vis.15 ~ Group, data = ancova_improve_vis_15) 
```


```{r}
kruskal.test(improve.ur.15 ~ Group, data = ancova_improve_ur_15) 
```




```{r}
shapiro.test(ancova_improve_novel_15$improve.novel.15)
```



```{r}
library(car)
aov1 = aov(improve.tech.15 ~ Group + aspiration, ancova_df)
Anova(aov1 ,type="III")
```
```{r}
library(car)
aov1 = aov(improve.vis.45 ~ Group + aspiration, ancova_improve_vis_45)
Anova(aov1 ,type="III")
```
```{r}
library(car)
aov1 = aov(improve.novel.45 ~ Group + aspiration, ancova_improve_novel_45)
Anova(aov1 ,type="III")
```
```{r}
library(car)
aov1 = aov(improve.novel.15 ~ Group + aspiration, ancova_improve_novel_15)
Anova(aov1 ,type="III")
```


```{r}
as.factor(ancova_df)
```

```{r}
colnames(ancova_df) <- c("Group", "novelty.phase5", "aspiration")

ancova_df$Group <- as.factor(ancova_df$Group)
ancova_df
```
 
```{r}
levels(ancova_df$Group)
```
 

```{r}
contrast1 = c(-1,-1,1,1)
contrast2 = c(0, 0,-1,1)
```

```{r}
contrasts(ancova_df$Group) = cbind(contrast1, contrast2)
```

```{r}
contrasts(ancova_df$Group)
```

```{r}
aov1 = aov(novelty.phase5 ~ Group + aspiration, ancova_df)
aov1
```

```{r}
summary.lm(aov1)
```
## Interpretation

> An ANOVA revealed that there was a significant effect of treatment on improve-tech-15 (F(1, 163) = 4.4915, p < 0.03561) while controlling for aspiration. Further investigation of the impact of professors’ ranks on their salaries using planned contrasts revealed that having any sort of solution transparency (solution transparency or full transparency) was associated with a significant increase in improve-tech-15 compared to having no transparency at all or having just performance transparency, t(163) = 2.391, p < 0.018 (two-tailed), but there is no significant difference between solution transparency and full transparency on improve-tech-15. 



```{r}
colnames(ancova_improve_vis_45) <- c("Group", "improve.vis.45", "aspiration")

ancova_improve_vis_45$Group <- as.factor(ancova_improve_vis_45$Group)
ancova_improve_vis_45
```

```{r}
levels(ancova_improve_vis_45$Group)
```

```{r}
contrasts(ancova_improve_vis_45$Group) = cbind(contrast1, contrast2)
```

```{r}
contrasts(ancova_improve_vis_45$Group)
```


```{r}
aov1 = aov(improve.vis.45 ~ Group + aspiration, ancova_improve_vis_45)
```

```{r}
summary.lm(aov1)
```

# Interpretation: 

> An ANOVA revealed that there was a significant effect of treatment on improve-vis-45 (F(1, 162) = 5.5306, p < 0.0294) while controlling for aspiration. Further investigation of the impact of treatment on the performance using planned contrasts revealed that having any sort of solution transparency (solution transparency or full transparency) was associated with a significant increase in improve-vis-45 compared to having no transparency at all or having just performance transparency, t(162) = 2.199, p < 0.0294 (two-tailed), but there is no significant difference between solution transparency and full transparency on improve-vis-45.

# MANOVA 

```{r}
scores_loc <- read.table("/Users/jialincheoh/Downloads/overall_phase4.csv", header=TRUE, sep = ",")
scores_loc
```



```{r}
ancova_add_loc_15 <- cbind(scores_loc[, c(3, 6, 81)], aspiration = survey$aspiration)
ancova_add_loc_15
```


```{r}
colnames(ancova_add_loc_15) <- c("Group", "novelty.phase5", "aspiration", "add.loc.sum")

ancova_add_loc_15$Group <- as.factor(ancova_add_loc_15$Group)
ancova_add_loc_15
```
```{r}
levels(ancova_add_loc_15$Group)
```

```{r}
contrasts(ancova_add_loc_15$Group) = cbind(contrast1, contrast2)
```

```{r}
contrasts(ancova_add_loc_15$Group)
```

```{r}
aov1 = aov(novelty.phase5 ~ Group + add.loc.sum, ancova_add_loc_15)
```

```{r}
summary.lm(aov1)
```
```{r}
scores_loc
```

```{r}
summary(lm(scores_loc$novelty.phase5~scores_loc$add.loc.15))
```
# Interpretation: 

>  We fit a regression model using add-loc-15 as the predictor and novelty score in phase 5 as the outcome
variable. Based on this analysis, we have cˆ =.2045 (t = 3.075, p = 0.00249 < 0.05) and thus add-loc-15 is
significantly related to novelty-phase5. 

```{r}
summary(lm(scores_loc$user.requirement.phase5~scores_loc$add.loc.15))
```
# Interpretation: 

>  We fit a regression model using add-loc-15 as the predictor and user requirement score in phase 5 as the outcome
variable. Based on this analysis, we have cˆ =.21082 (t = 2.932, p = 0.00387 < 0.05) and thus add-loc-15 is
significantly related to user-requirement-phase5. 


```{r}
summary(lm(scores_loc$user.requirement.phase5~scores_loc$add.loc.sum))

```
>  We fit a regression model using total number of lines of codes added BETWEEN Phase 1 and Phase 5 as the predictor and the absolute user requirement score at the end of phase 5 as the outcome variable. Based on this analysis, we have cˆ = 0.06014 (t = 2.793, p = 0.00588 *** < 0.05) and thus "total number of lines of codes added between phase 1 and phase 5" is significantly related to the absolute user requirement score at the end of phase 5.

```{r}
summary(lm(scores_loc$novelty.phase5~scores_loc$add.loc.sum))
```
>  We fit a regression model using total number of lines of codes added BETWEEN Phase 1 and Phase 5 as the predictor and the absolute novelty score at the end of phase 5 as the outcome variable. Based on this analysis, we have cˆ = 0.0865 (t = 4.497, p = 1.34e-05 *** < 0.05) and thus "total number of lines of codes added between phase 1 and phase 5" is significantly related to the absolute novelty score at the end of phase 5. 

```{r}
summary(lm(scores_loc$novelty.phase5~scores_loc$add.loc.sum + scores_loc$Group))
```



```{r}
summary(lm(scores_loc$novelty.phase5~scores_loc$Group))
```


# Interpretation: 

>  We fit a regression model using add-loc-15 as the predictor and user requirement score in phase 5 as the outcome
variable. Based on this analysis, we have cˆ =.21082 (t = 2.932, p = 0.00387 < 0.05) and thus add-loc-15 is
significantly related to user-requirement-phase5. 



```{r}
summary(lm(scores_loc$novelty.phase5~scores_loc$add.loc.sum))
```

```{r}
summary(lm(scores_loc$add.loc.sum~scores_loc$Group))
```

```{r}
summary(lm(scores_loc$add.loc.sum~scores_loc$Group))
```


```{r}
library(bmem)
m1 <- "scores_loc$user.requirement.phase5 = b*scores_loc$add.loc.15 + cp*scores_loc$Group
HE = a*ME"
```

```{r}
summary(lm(scores_loc$user.requirement.phase5~scores_loc$add.loc.15+scores_loc$Group))
```
```{r}
#install bda package if not already installed
install.packages('bda')

#load bda package
library(bda)
mediation.test(scores_loc$add.loc.15,scores_loc$Group,scores_loc$novelty.phase5)
```

```{r}
ancova_add_loc_15 <- cbind(scores_loc[, c(3, 61)], aspiration = survey$aspiration)
ancova_add_loc_15
```

```{r}
library(lavaan)
mediation<-'
novelty.phase5 ~ b*add.loc.sum + cp*Group
add.loc.sum ~ a*Group
ab := a*b
total := a*b + cp
'
mediation
```


```{r}
mediation.res <- sem(mediation, data=scores_loc)
summary(mediation.res)
```
```{r}
model2<-'
novelty.phase5 ~ b*add.loc.sum
add.loc.sum ~ a*Group'

model2.res<-sem(model2, data=scores_loc)
summary(model2.res)
```
> Hypothesis: There is no direct effect between Group and absolute novelty score in phase 5

> From the output, the Chi-square is 0.599 with 1 degree of freedom. The p-value is 0.439. Therefore,
the null hypothesis fail to be rejected. This indicates that the model without direct effect is a 
good model.


```{r}
summary(lm(scores_loc$add.loc.sum~scores_loc$Group))
```

```{r}
bogota_3 <- subset(scores_loc, Group == 3)
bogota_3
```
```{r}
bogota_2 <- subset(scores_loc, Group == 2)
bogota_2
```

```{r}
bogota_1 <- subset(scores_loc, Group == 1)
bogota_1
```


```{r}
summary(lm(bogota_3$user.requirement.phase5~bogota_3$sum.clicks.count))
```

```{r}
summary(lm(bogota_3$novelty.phase5~bogota_3$sum.clicks.count))
```
```{r}
summary(lm(bogota_2$user.requirement.phase5~bogota_2$sum.clicks.count))
```

```{r}
summary(lm(bogota_2$novelty.phase5~bogota_2$sum.clicks.count))
```
```{r}
summary(lm(bogota_1$novelty.phase5~bogota_1$sum.clicks.count))
```

```{r}
summary(lm(bogota_2$user.requirement.phase5~bogota_2$sum.clicks.count))
```

