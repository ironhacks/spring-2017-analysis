---
title: "R Notebook"
output: html_notebook
---

# Principle Component Analysis in R 

```{r}
# Loading required package: psych
require(psych)

# Loading required package: GPArotation
require(GPArotation)

library(lattice)
url <- "/Users/jialincheoh/Desktop/survey_final_read.csv"
survey <- read.csv(url, header=TRUE)
survey
```

```{r}
names(survey)[1:13] <- c("monetary_compensation", "excellent_programmer", "internship", 
                         "introduce_ideas", "get_in_touch", "known_creativity", "improve_skills", 
                         "test_capability", "enjoy_problems", "keep_up", "dissatisfaction", "curious", "pass_class")
survey
```

```{r}
# Extract all 13 survey items with motivation construct
motivation <- survey[c(1:13)]
motivation
```


```{r}
lowerCor(motivation)
```
```{r}
library(correlation)

correlation::correlation(motivation,
                         include_factors = TRUE, method = "auto"
)
```

```{r}
# Do the PCA with singular value decomposition of the (centered and possibly scaled) data matrix

my.prc = prcomp(motivation, center=TRUE, scale=TRUE)
screeplot(my.prc, main="Scree Plot", xlab="Components")
screeplot(my.prc, main="Scree Plot", type="line" )
```
```{r}
my.prc
```

```{r}
# Kaiser criterion to determine the number of principle components to keep 
my.prc$sdev ^ 2
```

```{r}

screeplot(my.prc, main="Scree Plot", xlab="Components")
```
```{r}
# DotPlot PC1

load    <- my.prc$rotation
sorted.loadings <- load[order(load[, 1]), 1]
myTitle <- "Loadings Plot for PC1" 
myXlab  <- "Variable Loadings"
dotplot(sorted.loadings, main=myTitle, xlab=myXlab, cex=1.5, col="red")
summary(my.prc)
```

```{r}
# DotPlot PC2

sorted.loadings <- load[order(load[, 2]), 2]
myTitle <- "Loadings Plot for PC2"
myXlab  <- "Variable Loadings"
dotplot(sorted.loadings, main=myTitle, xlab=myXlab, cex=1.5, col="red")
```
```{r}
# Now draw the BiPlot
biplot(my.prc, cex=c(1, 0.7))
```
```{r}
my.prc$rotation[, 1:2]
```
```{r}
options(max.print=1000000)
project.b = predict(my.prc, motivation)
project.b
```



```{r}
# Apply the Varimax Rotation
my.var <- varimax(my.prc$rotation[, 1:6])

my.var
```
## Interpretation: 

> Assume threshold 0.5 

> PC1 - Gain Knowledge and Intrinsic Innovation Interest ( only missed enjoy_problems )
> PC2 - Dissatisfaction 
> PC3 - Monetary rewards 
> PC4 - Curious 
> PC5 - Get known for excellent programmer / excellent creativity 
> PC6 - Show Ideas


```{r}
# Apply the Varimax Rotation
my.var <- varimax(my.prc$rotation[, 1:2])

my.var
```

```{r}
# Apply the Varimax Rotation
my.var <- varimax(my.prc$rotation[, 1:3])

my.var
```
```{r}
head(my.prc$x)
```

```{r}
summary(my.prc)
```

## Get the PCA scores for 163 participants 

```{r}
pca <- predict(my.prc, newdata=motivation)
pca
```

```{r}
print(my.prc)
```
```{r}
summary(motivation)
```



```{r}
head(my.prc$x)
```

```{r}
pca_frame <- as.data.frame(pca)
pca_frame
```

```{r}
allData <- cbind(pca_frame[1], id = survey$hack_id)
allData
```
```{r}
allData_abs_PC1 <- abs(allData)
allData_abs_PC1
```
```{r}
anova_1 <- as.data.frame(allData_abs_PC1)
anova_1
```

```{r}
ANOVA_RESULTS_1 <- aov(PC1 ~ id, data=anova_1)
summary(ANOVA_RESULTS_1)
```

## Interpretation

> No difference between all 4 groups for PC1 


```{r}
allData_abs_PC1$performance <- ifelse(allData_abs_PC1$id==1, 1,
        ifelse(allData_abs_PC1$id==2, 0,
        ifelse(allData_abs_PC1$id==0, 0,
        ifelse(allData_abs_PC1$id==3, 1, NA))))

allData_abs_PC1
```


```{r}
allData_abs_PC1$solution <- ifelse(allData_abs_PC1$id==1, 0,
        ifelse(allData_abs_PC1$id==2, 1,
        ifelse(allData_abs_PC1$id==0, 0,
        ifelse(allData_abs_PC1$id==3, 1, NA))))

allData_abs_PC1
```
.

```{r}
res <- t.test(PC1 ~ performance, data = allData_abs_PC1, var.equal = TRUE)
res
```
## Interpretation: 

> No difference between the two performance groups for PC1


```{r}
res <- t.test(PC1 ~ solution, data = allData_abs_PC1, var.equal = TRUE)
res
```

## Interpretation: 

> No difference between the two solution groups for PC1

```{r}
allData_PC2 <- cbind(pca_frame[2], id = survey$hack_id)
allData_PC2
```

```{r}
allData_abs_PC2 <- abs(allData_PC2)
allData_abs_PC2
```
 
```{r}
anova_2 <- as.data.frame(allData_abs_PC2)
anova_2
```
 
```{r}
ANOVA_RESULTS_2 <- aov(PC2 ~ id, data=anova_2)
summary(ANOVA_RESULTS_2)
```

## Interpretation: 

> No difference between the 4 groups for PC2 

```{r}
allData_abs_PC2$performance <- ifelse(allData_abs_PC2$id==1, 1,
        ifelse(allData_abs_PC2$id==2, 0,
        ifelse(allData_abs_PC2$id==0, 0,
        ifelse(allData_abs_PC2$id==3, 1, NA))))

allData_abs_PC2
```

 
```{r}
allData_abs_PC2$solution <- ifelse(allData_abs_PC2$id==1, 0,
        ifelse(allData_abs_PC2$id==2, 1,
        ifelse(allData_abs_PC2$id==0, 0,
        ifelse(allData_abs_PC2$id==3, 1, NA))))

allData_abs_PC2
```
 


## We’ll use F-test to test for homogeneity in variances
 
```{r}
res.ftest <- var.test(PC2 ~ performance, data = allData_abs_PC2)
res.ftest
```

## Interpretation: 

> The p-value of F-test is p = 0.3605. It’s greater than the significance level alpha = 0.05. In conclusion, there is no significant difference between the variances of the two sets of data. Therefore, we can use the classic t-test witch assume equality of the two variances.

```{r}
res <- t.test(PC2 ~ performance, data = allData_abs_PC2, var.equal = TRUE)
res
```
 
## Interpretation: 
 
 > The p-value of the test is 0.476, which is more than the significance level alpha = 0.05. We can conclude that the types of performance groups are NOT significantly different from each other. 
 
## We’ll use F-test to test for homogeneity in variances. 
 
```{r}
res.ftest <- var.test(PC2 ~ solution, data = allData_abs_PC2)
res.ftest
```
 
## Interpretation:

> The p-value of F-test is p = 0.4073. It’s greater than the significance level alpha = 0.05. In conclusion, there is no significant difference between the variances of the two sets of data. Therefore, we can use the classic t-test witch assume equality of the two variances.

```{r}
res <- t.test(PC2 ~ solution, data = allData_abs_PC2, var.equal = TRUE)
res
```
 
## Interpretation: 

> The p-value of the test is 0.8846, which is greater than the significance level alpha = 0.05. We can conclude that the types of solution groups are NOT significantly different from each other. 
 