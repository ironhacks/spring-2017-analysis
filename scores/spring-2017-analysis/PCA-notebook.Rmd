---
title: "R Notebook"
output: html_notebook
---

# Principle Component Analysis in R 

```{r}
# Loading required package: psych
require(psych)

# Loading required package: GPArotation
require(GPArotation)

library(lattice)
url <- "/Users/jialincheoh/Desktop/survey-motivation-WQ13.csv"
motivation <- read.csv(url, header=TRUE)
motivation
```
```{r}
lowerCor(motivation)
```
```{r}
library(correlation)

correlation::correlation(motivation,
                         include_factors = TRUE, method = "auto"
)
```

```{r}
# Do the PCA with singular value decomposition of the (centered and possibly scaled) data matrix

my.prc = prcomp(motivation, center=TRUE, scale=TRUE)
screeplot(my.prc, main="Scree Plot", xlab="Components")
screeplot(my.prc, main="Scree Plot", type="line" )
```
```{r}
my.prc
```

```{r}
# Kaiser criterion to determine the number of principle components to keep 
my.prc$sdev ^ 2
```

```{r}

screeplot(my.prc, main="Scree Plot", xlab="Components")
```
```{r}
# DotPlot PC1

load    <- my.prc$rotation
sorted.loadings <- load[order(load[, 1]), 1]
myTitle <- "Loadings Plot for PC1" 
myXlab  <- "Variable Loadings"
dotplot(sorted.loadings, main=myTitle, xlab=myXlab, cex=1.5, col="red")
summary(my.prc)
```

```{r}
# DotPlot PC2

sorted.loadings <- load[order(load[, 2]), 2]
myTitle <- "Loadings Plot for PC2"
myXlab  <- "Variable Loadings"
dotplot(sorted.loadings, main=myTitle, xlab=myXlab, cex=1.5, col="red")
```
```{r}
# Now draw the BiPlot
biplot(my.prc, cex=c(1, 0.7))
```
```{r}
# Apply the Varimax Rotation
my.var <- varimax(my.prc$rotation[, 1:6])

my.var
```
## Interpretation: 

> Assume threshold 0.5 

> PC1 - Gain Knowledge and Intrinsic Innovation Interest ( only missed enjoy_problems )
> PC2 - Dissatisfaction 
> PC3 - Monetary rewards 
> PC4 - Curious 
> PC5 - Get known for excellent programmer / excellent creativity 
> PC6 - Show Ideas


```{r}
# Apply the Varimax Rotation
my.var <- varimax(my.prc$rotation[, 1:2])

my.var
```

```{r}
# Apply the Varimax Rotation
my.var <- varimax(my.prc$rotation[, 1:3])

my.var
```


