---
title: "R Notebook"
output: html_notebook
---

```{r}
df <- read.csv("merged-new-version2.csv", header =TRUE, sep=",")
#df <- df[!complete.cases(df), ]  
df
```


```{r}
df$ln_novelty <- log(df$novelty+1)
df$ln_total <- log(df$total+1) 
df$ln_exploration <- log(df$exploration+1) 
df$group = factor(df$group)
df
```
```{r}
df$group <- relevel(df$group, ref = "3")
mod <- lm(ln_exploration ~ factor(group), data=df)
summary(mod)
```

```{r}
df$group <- relevel(df$group, ref = "3")
mod <- lm(ln_total ~ factor(group), data=df)
summary(mod)
```

```{r}
df$group <- relevel(df$group, ref = "3")
mod <- lm(ln_novelty ~ factor(group), data=df)
summary(mod)
```
```{r}
df$group <- relevel(df$group, ref = "3")
mod <- lm(ln_exploration ~ factor(group) + Q7_Q7_1 + Q7_Q7_2 + Q8_Q8_1 + Q10 + count, data=df)
summary(mod)
```


```{r}
df$group <- relevel(df$group, ref = "3")
mod <- lm(ln_novelty ~ factor(group) + Q7_Q7_1 + Q7_Q7_2 + Q8_Q8_1 + Q10 + count, data=df)
summary(mod)
```

```{r}
df$group <- relevel(df$group, ref = "3")
mod1 <- lm(ln_novelty ~ factor(group) + Q7_Q7_1 + Q7_Q7_2 + Q8_Q8_1 + Q10 + count, data=df)
summary(mod1)
```

```{r}
anova(mod, mod1)
```


```{r}
library(lmerTest)
fit.lmer <- lmer(ln_novelty ~ factor(group) + ( 1 | phase), data = df, REML= FALSE)
fit.lmer
``` 

```{r}
tapply(df$ln_novelty, df$group, summary)
```

```{r}
tapply(df$ln_total, df$group, summary)
```
```{r}
tapply(df$ln_exploration, df$group, summary)
```

```{r}
library(vtree)
vtree(df, "group")
```
```{r}
vtree(df, c("phase", "group"), 
   fillcolor = c( phase = "#e7d4e8", group = "#99d8c9"),
   horiz = FALSE)
```


```{r}
df$group <- relevel(df$group, ref = "3")
mod <- lm(ln_total ~ factor(group) + Q7_Q7_1 + Q7_Q7_2 + Q8_Q8_1 + Q10 + count, data=df)
summary(mod)
```
```{r}
with(df, interaction.plot(group, phase, ln_total, ylim=c(0, max(ln_total)))) # interaction plot
```

```{r}
with(df, interaction.plot(group, phase, ln_novelty, ylim=c(0, max(ln_novelty)))) # interaction plot
```

```{r}
with(df, interaction.plot(group, phase, ln_exploration, ylim=c(0, max(ln_exploration)))) # interaction plot
```



```{r}
with(df, interaction.plot(group, phase, ln_novelty, ylim=c(0, max(ln_novelty)))) # interaction plot
```

