---
title: "R Notebook"
output: html_notebook
---

This is an [R Markdown](http://rmarkdown.rstudio.com) Notebook. When you execute code within the notebook, the results appear beneath the code. 

Try executing this chunk by clicking the *Run* button within the chunk or by placing your cursor inside it and pressing *Cmd+Shift+Enter*. 

```{r}
# library for LMM 

library(lme4)
library(lmerTest)
library(car)
```



```{r}
df<-read.csv("overall_scores.csv", header =TRUE, sep=",")
df
```

```{r}
mod <- lm( novelty ~ factor(Group), data = df)
summary(mod)
```
```{r}
mod <- lm(user.requirement ~ factor(Group) , data = df)
summary(mod)
```
```{r}
mod <- lm( infovis ~ factor(Group) , data = df)
summary(mod)
```

```{r}
mod <- lm( total ~ factor(Group) , data = df)
summary(mod)
```

```{r}
# convert to nominal factor
df$Group = factor(df$Group)
df$phase = factor(df$phase)
```

```{r}
library(plyr)
ddply(df, ~ Group * phase, function(data) summary(data$novelty) )
ddply(df, ~ Group * phase, summarise, novelty.mean=mean(novelty), novelty.sd = sd(novelty))
```
```{r}
# histograms for two factors
hist(df[df$Group == 0 & df$phase == 1,]$novelty)
hist(df[df$Group == 0 & df$phase == 2,]$novelty)
hist(df[df$Group == 0 & df$phase == 3,]$novelty)
hist(df[df$Group == 0 & df$phase == 4,]$novelty)
hist(df[df$Group == 1 & df$phase == 1,]$novelty)
hist(df[df$Group == 1 & df$phase == 2,]$novelty)
hist(df[df$Group == 1 & df$phase == 3,]$novelty)
hist(df[df$Group == 1 & df$phase == 4,]$novelty)
hist(df[df$Group == 2 & df$phase == 1,]$novelty)
hist(df[df$Group == 2 & df$phase == 2,]$novelty)
hist(df[df$Group == 2 & df$phase == 3,]$novelty)
hist(df[df$Group == 2 & df$phase == 4,]$novelty)
hist(df[df$Group == 3 & df$phase == 1,]$novelty)
hist(df[df$Group == 3 & df$phase == 2,]$novelty)
hist(df[df$Group == 3 & df$phase == 3,]$novelty)
hist(df[df$Group == 3 & df$phase == 4,]$novelty)
boxplot(novelty ~ Group * phase, data = df, xlab="Group.Phase", ylab="novelty")
with(df, interaction.plot(Group, phase, novelty, ylim=c(0, max(novelty)))) # interaction plot
```

```{r}
m = lmer(novelty ~ Group + (1|Student), data=df, REML=FALSE)
summary(m)
```
```{r}
plot(resid(m, type = "pearson") ~ fitted(m))
qqnorm(resid(m, type = "pearson"))
qqline(resid(m, type = "pearson"))
```
```{r}
# library for LMM we will use on relational novelty 

library(lme4)
library(lmerTest)
library(car)
```

# set sum-to-zero contrast for ANOVA cells 

```{r}
contrasts(df$Group) <= "contr.sum"
contrasts(df$phase) <= "contr.sum"
```

```{r}
# phase is nested within group 
fit <- lmer(novelty ~ ( Group / phase ) +  ( 1 | Student), data = df, REML = FALSE)
Anova(fit, type=3, test.statistics="F")
fit
```

```{r}
library(multcomp)
library(lsmeans)
summary(glht(fit, lsm(pairwise ~ Group / phase)), test = adjusted(type='holm'))
```

```{r}
fit.full <- lmer(novelty ~ ( Group / phase ) + Q7_Q7_1 + Q7_Q7_2 + Q8_Q8_1 + Q10 + ( 1 | Student), data = df, REML = FALSE)
Anova(fit.full, type=3, test.statistics="F")
fit.full
```

# User Requirement Score

```{r}
# phase is nested within group 
fit.requirement.full <- lmer(user.requirement ~ ( Group / phase ) + Q7_Q7_1 + Q7_Q7_2 + Q8_Q8_1 + Q10 + ( 1 | Student), data = df, REML = FALSE)
Anova(fit.requirement.full, type=3, test.statistics="F")
fit.requirement.full
```

```{r}
# histograms for two factors
boxplot(user.requirement ~ Group * phase, data = df, xlab="Group.Phase", ylab="user.requirement")
with(df, interaction.plot(Group, phase, user.requirement, ylim=c(0, max(user.requirement)))) # interaction plot
```


```{r}
# phase is nested within group 
fit.requirement <- lmer(user.requirement ~ ( Group / phase ) +  ( 1 | Student), data = df, REML = FALSE)
Anova(fit, type=3, test.statistics="F")
fit.requirement
```

```{r}
plot(resid(m, type = "pearson") ~ fitted(m))
qqnorm(resid(m, type = "pearson"))
qqline(resid(m, type = "pearson"))
```



```{r}
anova(fit.requirement, fit.requirement.full)
```
 
