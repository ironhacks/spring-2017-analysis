---
title: "R Notebook"
output: html_notebook
---

This is an [R Markdown](http://rmarkdown.rstudio.com) Notebook. When you execute code within the notebook, the results appear beneath the code. 

Try executing this chunk by clicking the *Run* button within the chunk or by placing your cursor inside it and pressing *Cmd+Shift+Enter*. 

```{r}
scores <- read.table("/Users/jialincheoh/Library/CloudStorage/Box-Box/NSF IronHacks App 2016 - 2019/05 Experiments 2017/01 Hack Spring 2017/01 Summary Spring 2017/02 Data/processed-data/overall_score_click_result.csv", header=TRUE, sep = ",")
scores
```

```{r}
survey <- read.table("/Users/jialincheoh/Library/CloudStorage/Box-Box/NSF IronHacks App 2016 - 2019/05 Experiments 2017/01 Hack Spring 2017/01 Summary Spring 2017/02 Data/processed-data/survey_final_read.csv", header=TRUE, sep = ",", stringsAsFactors=T)
names(survey)[35] <- "aspiration"
survey
```
```{r}
ancova_novelty_phase5 <- cbind(scores[, c(3, 6)], aspiration = survey$aspiration)
ancova_novelty_phase5
```

```{r}
ancova_vis_phase5 <- cbind(scores[, c(3, 5)], aspiration = survey$aspiration)
ancova_vis_phase5
```

```{r}
ancova_ur_phase5 <- cbind(scores[, c(3, 4)], aspiration = survey$aspiration)
ancova_ur_phase5
```

```{r}
ancova_tech_phase5 <- cbind(scores[, c(3, 8)], aspiration = survey$aspiration)
ancova_tech_phase5
```
```{r}
colnames(ancova_novelty_phase5) <- c("Group", "novelty.phase5", "aspiration")

ancova_novelty_phase5$Group <- as.factor(ancova_novelty_phase5$Group)
ancova_novelty_phase5
```

```{r}
levels(ancova_novelty_phase5$Group)
```

```{r}
contrast1 = c(-1,-1,1,1)
contrast2 = c(0, 0,-1,1)
```

```{r}
contrasts(ancova_novelty_phase5$Group) = cbind(contrast1, contrast2)
```


```{r}
contrasts(ancova_novelty_phase5$Group)
```

```{r}
aov1 = aov(novelty.phase5 ~ Group + aspiration, ancova_novelty_phase5)
aov1
```
```{r}
summary.lm(aov1)
```
```{r}
colnames(ancova_ur_phase5) <- c("Group", "user.requirement.phase5", "aspiration")

ancova_ur_phase5$Group <- as.factor(ancova_ur_phase5$Group)
ancova_ur_phase5
```

```{r}
levels(ancova_ur_phase5$Group)
```

```{r}
contrast1 = c(-1,-1,1,1)
contrast2 = c(0, 0,-1,1)
```


```{r}
contrasts(ancova_ur_phase5$Group) = cbind(contrast1, contrast2)
```


```{r}
contrasts(ancova_ur_phase5$Group)
```

```{r}
aov1 = aov(user.requirement.phase5 ~ Group + aspiration, ancova_ur_phase5)
aov1
```


```{r}
summary.lm(aov1)
```


```{r}
r <- lm(novelty.phase5 ~ factor(Group) + sum.add.loc, data=scores, psi=psi.bisquare) 
summary(r)
```


```{r}
library(MASS)



r <- rlm(novelty.phase5 ~ factor(Group) + sum.add.loc, data=scores, psi=psi.bisquare) 
summary(r)
```
```{r}
library(boot)
boot.huber <- function(data, indices, maxit=100){
  data <- data[indices,]
  mod <- rlm(novelty.phase5 ~ factor(Group) + sum.add.loc, data=data, maxit=maxit)
  coefficients(mod)
}
robust.boot<-boot(data=scores, statistic=boot.huber, R=100, maxit=100)

boot.ci(robust.boot, index=1, type="perc")
boot.ci(robust.boot, index=2, type="perc")
boot.ci(robust.boot, index=3, type="perc")
boot.ci(robust.boot, index=4, type="perc") 
boot.ci(robust.boot, index=5, type="perc") 


```








