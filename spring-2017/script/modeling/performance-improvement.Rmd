---
title: "R Notebook"
output: html_notebook
---


```{r}
# library for LMM 

library(lme4)
library(lmerTest)
library(car)
```

```{r}
df<-read.csv("input/improve_scores.csv", header =TRUE, sep=",")
df <- df[complete.cases(df), ]  # Apply complete.cases function
df
```
```{r}
df$log_improve_novel <- log(df$improve.novel+400) 
df$log_improve_ur<- log(df$improve.ur+400)
df$log_improve_vis<- log(df$improve.vis+400)
df$log_improve_total<- log(df$improve.total+400)
df$log_Q7_Q7_1<- log(df$Q7_Q7_1+400)
df$log_Q7_Q7_2<- log(df$Q7_Q7_2+400)
df$log_Q8_Q8_1<- log(df$Q8_Q8_1+400)
df$log_Q10<- log(df$Q10+400)
df$log_count<- log(df$count+400)

```


```{r}
# standardizing variables for skills and aspirations. 
cols <- c("log_Q7_Q7_1", "log_Q7_Q7_2", "log_Q8_Q8_1", "log_Q10", "log_improve_novel", "log_improve_ur", "log_improve_vis", "log_improve_total")
df[cols] <- scale(df[cols])
df
```


```{r}
mod.full <- lm( log_improve_novel ~ factor(Group) + log_count + log_Q7_Q7_1 + log_Q7_Q7_2 + log_Q8_Q8_1 +  log_Q10, data = df)
summary(mod.full)
```
```{r}
mod.reduced <- lm( log_improve_novel ~ log_count + log_Q7_Q7_1 + log_Q7_Q7_2 + log_Q8_Q8_1 +  log_Q10, data = df)
summary(mod.reduced)
```

```{r}
anova(mod.reduced, mod.full)
```


```{r}
mod <- lm( improve.ur ~ factor(Group), data = df)
summary(mod)
```
```{r}
mod <- lm( improve.vis ~ factor(Group), data = df)
summary(mod)
```
```{r}
mod <- lm( improve.total ~ factor(Group) + Q7_Q7_1 + Q7_Q7_2 + Q8_Q8_1 + Q10, data = df)
summary(mod)
```
```{r}
# convert to nominal factor
df$Group = factor(df$Group)
df$stage = factor(df$stage)
```
 

