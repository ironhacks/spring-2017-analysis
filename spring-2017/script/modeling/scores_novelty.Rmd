---
title: "R Notebook"
output: html_notebook
---

 
```{r}
# reading input 
df<-read.csv("input/scores_novelty.csv", header =TRUE, sep=",")
df <- df[complete.cases(df), ]  
df
```

```{r}
df$group = factor(df$group)
df$stage = factor(df$stage)
```

```{r}
df$log_relational_novelty <- log(df$similarity+1) 
df$log_count <- log(df$count+1) 
df$log_improve_total<- log(df$improve.total+350)
df$Q7_Q7_1 <- log(df$Q7_Q7_1+1)
df$Q7_Q7_2 <- log(df$Q7_Q7_2+1)
df$Q8_Q8_1 <- log(df$Q8_Q8_1+1)
df$Q10 <- log(df$Q10+1)
df
```

```{r}
cols <- c("Q7_Q7_1", "Q7_Q7_2", "Q8_Q8_1", "Q10", "log_relational_novelty", "log_count", "log_improve_total")
df[cols] <- scale(df[cols])
df
```


```{r}
mod0 <- lm(log_relational_novelty ~ Q7_Q7_1 + Q7_Q7_2 + Q8_Q8_1 + Q10 + log_count, data = df )
summary(mod0)
```

```{r}
mod1 <- lm(log_relational_novelty ~ Q7_Q7_1 + Q7_Q7_2 + Q8_Q8_1 + Q10 + group, data = df )
summary(mod1)
```

```{r}
mod2<- lm(log_relational_novelty ~ Q7_Q7_1 + Q7_Q7_2 + Q8_Q8_1 + Q10 + log_count + group, data = df )
summary(mod2)
AIC(mod2)
```

```{r}
mod2b<- lm(log_relational_novelty ~ Q7_Q7_1 + Q7_Q7_2 + Q8_Q8_1 + Q10 + log_count + group + log_improve_total, data = df )
summary(mod2b)
AIC(mod2b)
```

```{r}
anova(mod2, mod2b)
```


```{r}
mod3<- lm(log_relational_novelty ~ Q7_Q7_1 + Q7_Q7_2 + Q8_Q8_1 + Q10 + log_count + group + group * log_improve_total, data = df )
summary(mod3)
AIC(mod3)
```

```{r}
anova(mod2, mod3)
```

```{r}
anova(mod2b, mod3)
```


```{r}
library(car)
vif(mod3)
```

```{r}
check_collinearity(mod3)
```



